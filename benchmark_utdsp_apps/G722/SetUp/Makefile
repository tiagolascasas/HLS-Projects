#
#	Copyright (c) 1994 - Corinna G. Lee, University of Toronto
#
.SILENT:
.IGNORE:
TAG = "-----"
DataName = proud_of_wars
#
# Set up symbolic links in sub-directories for input files (based on
# documentation in test722DSP file).
#
setup:
	ln -s ../SNDfiles/$(DataName).linearPCM.ascii QMF.transmit/input.dsp
	ln -s ../QMF.transmit/output.sun    SB-ADPCM.higher/encoder/input.dsp
	ln -s ../QMF.transmit/output.sun    SB-ADPCM.lower/encoder/input.dsp
	ln -s ../encoder/output.sun 	    SB-ADPCM.higher/decoder/input.dsp
	ln -s ../encoder/output.sun 	    SB-ADPCM.lower/decoder/input.dsp
	ln -s ../ReceiveMerger/fullSB	    QMF.receive/input.dsp
#	ln -s ../QMF.transmit/output.sun    QMF.receive/input.dsp

# FOLLOWING NEEDS TO BE REVISED
#
# Internal checks to ensure that outputs of encoder and decoder match
# corresponding outputs generated by original code copied from the network.
#
ORIGINAL = ../G721.MarcusLee/Original
CONVERT = ../G721.MarcusLee/SetUp/convert
validate:
	echo " "
	echo "$(TAG) Internally VALIDATing `pwd`"
	cd $(ORIGINAL) ; runADPCM $(DataName)
	make DataType="pcm" OutputFile="Fsqueezeby2/output.sun" compare
	-$(CONVERT) -p Fsqueezeby2/output.sun /tmp/$(DataName).auP
	make DataType="au" OutputFile="/tmp/$(DataName).auP" compare

compare:
	echo "$(TAG) CMPing $(DataType) versions ...."
	cmp $(OutputFile) $(ORIGINAL)/outputs/$(DataName).$(DataType)P
	echo "$(TAG) DONE"
